<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NHS Healthcare Costing AI Chatbot Demo</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide-react@latest/dist/umd/lucide-react.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
                'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
                sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        .animate-bounce {
            animation: bounce 1s infinite;
        }
        @keyframes bounce {
            0%, 20%, 53%, 80%, 100% {
                transform: translateY(0);
            }
            40%, 43% {
                transform: translateY(-30px);
            }
            70% {
                transform: translateY(-15px);
            }
            90% {
                transform: translateY(-4px);
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useRef, useEffect } = React;
        const { Send, User, Bot, Phone, Mail, CheckCircle } = lucideReact;

        const NHSCostingChatbot = () => {
            const [messages, setMessages] = useState([
                {
                    type: 'bot',
                    content: "Hello! I'm your NHS Healthcare Costing Assistant. I can help you with patient-level costing queries, our analytics solutions, or connect you with our specialist team. How can I assist you today?",
                    timestamp: new Date()
                }
            ]);
            const [input, setInput] = useState('');
            const [isTyping, setIsTyping] = useState(false);
            const [showEscalation, setShowEscalation] = useState(false);
            const messagesEndRef = useRef(null);

            // NHS Healthcare Costing Knowledge Base
            const knowledgeBase = {
                'patient level costing': {
                    keywords: ['patient level costing', 'plc', 'patient costing', 'nhs costing'],
                    response: "Patient Level Costing (PLC) is the NHS methodology for calculating the true cost of individual patient care episodes. Our platform helps trusts implement accurate PLC by integrating clinical and financial data, enabling better resource allocation and benchmarking. Would you like to know more about our PLC implementation services or data integration capabilities?"
                },
                'nhs standards': {
                    keywords: ['nhs standards', 'costing standards', 'hfma', 'reference costs'],
                    response: "We ensure full compliance with NHS costing standards including HFMA guidelines and reference cost requirements. Our solution supports the National Cost Collection, mandatory costing standards, and integrates with existing NHS systems like SUS and PAS. Need specific information about compliance features?"
                },
                'analytics': {
                    keywords: ['analytics', 'reporting', 'dashboards', 'insights', 'data analysis'],
                    response: "Our analytics platform provides real-time cost insights, variance analysis, and predictive modeling for healthcare costs. We offer customizable dashboards, automated reporting, and AI-driven cost optimization recommendations. What specific analytics capabilities are you interested in exploring?"
                },
                'ai features': {
                    keywords: ['ai', 'artificial intelligence', 'machine learning', 'predictive', 'automation'],
                    response: "Our AI capabilities include predictive cost modeling, automated cost allocation, anomaly detection in costing data, and intelligent benchmarking. We use machine learning to identify cost-saving opportunities and improve costing accuracy. Would you like a demo of our AI-powered features?"
                },
                'integration': {
                    keywords: ['integration', 'api', 'systems', 'pas', 'sus', 'epic', 'cerner'],
                    response: "We integrate seamlessly with major NHS systems including PAS, SUS, EPR systems (Epic, Cerner, Allscripts), and finance systems. Our APIs ensure real-time data flow and maintain data integrity across your technology stack. Need technical details about specific integrations?"
                },
                'implementation': {
                    keywords: ['implementation', 'setup', 'go-live', 'training', 'support'],
                    response: "Our implementation process typically takes 8-12 weeks and includes data migration, system configuration, staff training, and go-live support. We provide dedicated project management and ongoing technical support. This sounds like something our implementation team should discuss with you directly - shall I arrange a consultation?"
                }
            };

            // Escalation triggers
            const escalationTriggers = [
                'pricing', 'cost', 'quote', 'contract', 'demo', 'meeting', 'call', 'speak to someone',
                'implementation timeline', 'technical requirements', 'compliance audit', 'procurement'
            ];

            const scrollToBottom = () => {
                messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });
            };

            useEffect(() => {
                scrollToBottom();
            }, [messages]);

            const findBestResponse = (userInput) => {
                const input = userInput.toLowerCase();
                
                // Check for escalation triggers first
                const needsEscalation = escalationTriggers.some(trigger => 
                    input.includes(trigger.toLowerCase())
                );
                
                if (needsEscalation) {
                    return {
                        response: "I can see you're interested in discussing specific requirements, pricing, or technical details. Let me connect you with one of our specialists who can provide detailed information tailored to your needs.",
                        escalate: true
                    };
                }

                // Search knowledge base
                for (const [topic, data] of Object.entries(knowledgeBase)) {
                    if (data.keywords.some(keyword => input.includes(keyword.toLowerCase()))) {
                        return { response: data.response, escalate: false };
                    }
                }

                // Default responses for common queries
                if (input.includes('hello') || input.includes('hi')) {
                    return { response: "Hello! I'm here to help with NHS patient-level costing questions. What would you like to know about our analytics platform or costing solutions?", escalate: false };
                }

                if (input.includes('help')) {
                    return { response: "I can help you with:\n• Patient Level Costing methodology and implementation\n• NHS costing standards and compliance\n• Analytics and reporting capabilities\n• AI-powered cost optimization\n• System integrations\n• Implementation planning\n\nWhat specific area interests you most?", escalate: false };
                }

                // Generic fallback with escalation option
                return {
                    response: "I'd be happy to help you with that! While I have extensive knowledge about NHS patient-level costing and our analytics solutions, your specific question might benefit from one of our specialists. Would you like me to connect you with our team, or is there a particular aspect of healthcare costing I can help explain?",
                    escalate: false,
                    offerEscalation: true
                };
            };

            const handleSendMessage = async () => {
                if (!input.trim()) return;

                const userMessage = {
                    type: 'user',
                    content: input,
                    timestamp: new Date()
                };

                setMessages(prev => [...prev, userMessage]);
                setInput('');
                setIsTyping(true);

                // Simulate AI processing delay
                setTimeout(() => {
                    const aiResponse = findBestResponse(input);
                    
                    const botMessage = {
                        type: 'bot',
                        content: aiResponse.response,
                        timestamp: new Date(),
                        escalate: aiResponse.escalate,
                        offerEscalation: aiResponse.offerEscalation
                    };

                    setMessages(prev => [...prev, botMessage]);
                    setIsTyping(false);

                    if (aiResponse.escalate) {
                        setShowEscalation(true);
                    }
                }, 1000 + Math.random() * 1000);
            };

            const handleEscalation = (method) => {
                const escalationMessage = {
                    type: 'bot',
                    content: method === 'call' 
                        ? "Perfect! I'll have one of our NHS costing specialists call you within the next business hour. Please ensure your contact details are up to date. In the meantime, feel free to ask me any other questions!"
                        : "Great! I'll send your inquiry to our team and you'll receive a detailed response via email within 2 hours. Our specialists will include relevant case studies and technical documentation. Anything else I can help with right now?",
                    timestamp: new Date(),
                    escalationConfirmed: true
                };
                
                setMessages(prev => [...prev, escalationMessage]);
                setShowEscalation(false);
            };

            return React.createElement('div', {
                className: "flex flex-col h-screen max-w-4xl mx-auto bg-white"
            }, [
                // Header
                React.createElement('div', {
                    key: 'header',
                    className: "bg-blue-600 text-white p-4 shadow-lg"
                }, 
                    React.createElement('div', {
                        className: "flex items-center space-x-3"
                    }, [
                        React.createElement(Bot, { key: 'bot-icon', className: "w-8 h-8" }),
                        React.createElement('div', { key: 'header-text' }, [
                            React.createElement('h1', { key: 'title', className: "text-xl font-bold" }, "NHS Healthcare Costing Assistant"),
                            React.createElement('p', { key: 'subtitle', className: "text-blue-100 text-sm" }, "Specialist support for patient-level costing & analytics")
                        ])
                    ])
                ),

                // Messages
                React.createElement('div', {
                    key: 'messages',
                    className: "flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50"
                }, [
                    ...messages.map((message, index) =>
                        React.createElement('div', {
                            key: index,
                            className: `flex ${message.type === 'user' ? 'justify-end' : 'justify-start'}`
                        },
                            React.createElement('div', {
                                className: `flex items-start space-x-2 max-w-3xl ${message.type === 'user' ? 'flex-row-reverse space-x-reverse' : ''}`
                            }, [
                                React.createElement('div', {
                                    key: 'avatar',
                                    className: `w-8 h-8 rounded-full flex items-center justify-center ${
                                        message.type === 'user' ? 'bg-blue-500' : 'bg-green-500'
                                    }`
                                },
                                    message.type === 'user' 
                                        ? React.createElement(User, { className: "w-4 h-4 text-white" })
                                        : React.createElement(Bot, { className: "w-4 h-4 text-white" })
                                ),
                                React.createElement('div', {
                                    key: 'message-content',
                                    className: `rounded-lg p-3 ${
                                        message.type === 'user' 
                                            ? 'bg-blue-500 text-white' 
                                            : 'bg-white text-gray-800 shadow-md border'
                                    }`
                                }, [
                                    React.createElement('p', { key: 'text', className: "whitespace-pre-wrap" }, message.content),
                                    React.createElement('div', {
                                        key: 'message-footer',
                                        className: "flex items-center justify-between mt-2"
                                    }, [
                                        React.createElement('span', {
                                            key: 'timestamp',
                                            className: `text-xs ${message.type === 'user' ? 'text-blue-100' : 'text-gray-500'}`
                                        }, message.timestamp.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })),
                                        message.escalationConfirmed && React.createElement(CheckCircle, {
                                            key: 'check',
                                            className: "w-4 h-4 text-green-500"
                                        })
                                    ]),
                                    
                                    // Escalation buttons
                                    (message.escalate || message.offerEscalation) && !showEscalation && !message.escalationConfirmed &&
                                    React.createElement('div', {
                                        key: 'escalation',
                                        className: "mt-3 pt-3 border-t border-gray-200"
                                    }, [
                                        React.createElement('p', {
                                            key: 'escalation-text',
                                            className: "text-sm text-gray-600 mb-2"
                                        }, "How would you prefer to connect with our team?"),
                                        React.createElement('div', {
                                            key: 'escalation-buttons',
                                            className: "flex space-x-2"
                                        }, [
                                            React.createElement('button', {
                                                key: 'call-btn',
                                                onClick: () => handleEscalation('call'),
                                                className: "flex items-center space-x-1 bg-blue-500 text-white px-3 py-1 rounded text-sm hover:bg-blue-600 transition-colors"
                                            }, [
                                                React.createElement(Phone, { key: 'phone-icon', className: "w-3 h-3" }),
                                                React.createElement('span', { key: 'call-text' }, "Schedule Call")
                                            ]),
                                            React.createElement('button', {
                                                key: 'email-btn',
                                                onClick: () => handleEscalation('email'),
                                                className: "flex items-center space-x-1 bg-green-500 text-white px-3 py-1 rounded text-sm hover:bg-green-600 transition-colors"
                                            }, [
                                                React.createElement(Mail, { key: 'mail-icon', className: "w-3 h-3" }),
                                                React.createElement('span', { key: 'email-text' }, "Email Response")
                                            ])
                                        ])
                                    ])
                                ])
                            ])
                        )
                    ),
                    
                    // Typing indicator
                    isTyping && React.createElement('div', {
                        key: 'typing',
                        className: "flex justify-start"
                    },
                        React.createElement('div', {
                            className: "flex items-start space-x-2"
                        }, [
                            React.createElement('div', {
                                key: 'typing-avatar',
                                className: "w-8 h-8 rounded-full bg-green-500 flex items-center justify-center"
                            },
                                React.createElement(Bot, { className: "w-4 h-4 text-white" })
                            ),
                            React.createElement('div', {
                                key: 'typing-bubble',
                                className: "bg-white rounded-lg p-3 shadow-md border"
                            },
                                React.createElement('div', {
                                    className: "flex space-x-1"
                                }, [
                                    React.createElement('div', { key: 'dot1', className: "w-2 h-2 bg-gray-400 rounded-full animate-bounce" }),
                                    React.createElement('div', { key: 'dot2', className: "w-2 h-2 bg-gray-400 rounded-full animate-bounce", style: { animationDelay: '0.1s' } }),
                                    React.createElement('div', { key: 'dot3', className: "w-2 h-2 bg-gray-400 rounded-full animate-bounce", style: { animationDelay: '0.2s' } })
                                ])
                            )
                        ])
                    ),
                    React.createElement('div', { key: 'scroll-anchor', ref: messagesEndRef })
                ]),

                // Input
                React.createElement('div', {
                    key: 'input-area',
                    className: "p-4 bg-white border-t"
                }, [
                    React.createElement('div', {
                        key: 'input-container',
                        className: "flex space-x-2"
                    }, [
                        React.createElement('input', {
                            key: 'input',
                            type: "text",
                            value: input,
                            onChange: (e) => setInput(e.target.value),
                            onKeyPress: (e) => e.key === 'Enter' && handleSendMessage(),
                            placeholder: "Ask about NHS patient-level costing, analytics, or our solutions...",
                            className: "flex-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",
                            disabled: isTyping
                        }),
                        React.createElement('button', {
                            key: 'send-btn',
                            onClick: handleSendMessage,
                            disabled: isTyping || !input.trim(),
                            className: "bg-blue-500 text-white p-3 rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"
                        },
                            React.createElement(Send, { className: "w-5 h-5" })
                        )
                    ]),
                    
                    // Quick suggestions
                    React.createElement('div', {
                        key: 'suggestions',
                        className: "flex flex-wrap gap-2 mt-3"
                    },
                        ['What is Patient Level Costing?', 'NHS compliance features', 'AI analytics demo', 'Integration options'].map((suggestion, index) =>
                            React.createElement('button', {
                                key: index,
                                onClick: () => setInput(suggestion),
                                className: "text-sm bg-gray-100 text-gray-700 px-3 py-1 rounded-full hover:bg-gray-200 transition-colors"
                            }, suggestion)
                        )
                    )
                ]),

                // Status bar
                React.createElement('div', {
                    key: 'status',
                    className: "bg-gray-100 px-4 py-2 text-xs text-gray-600 flex items-center justify-between"
                }, [
                    React.createElement('div', {
                        key: 'status-left',
                        className: "flex items-center space-x-2"
                    }, [
                        React.createElement('div', { key: 'status-dot', className: "w-2 h-2 bg-green-500 rounded-full" }),
                        React.createElement('span', { key: 'status-text' }, "AI Assistant Online")
                    ]),
                    React.createElement('div', {
                        key: 'status-right',
                        className: "flex items-center space-x-4"
                    }, [
                        React.createElement('span', { key: 'response-time' }, "Response time: <2 seconds"),
                        React.createElement('span', { key: 'team-hours' }, "Team available: 9AM-6PM GMT")
                    ])
                ])
            ]);
        };

        ReactDOM.render(React.createElement(NHSCostingChatbot), document.getElementById('root'));
    </script>
</body>
</html>
